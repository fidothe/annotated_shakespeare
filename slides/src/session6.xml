<?dbhtml pygments="true"?>
<slides xml:lang="en" xmlns="http://docbook.org/ns/docbook"
  xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink">
  <info>
    <title>Practical Web Applications</title>
    <subtitle>Session Six</subtitle>
    <!-- authors are alphabetical by first name (I get sick of being listed last all the time, 
so I always do this if I can) -->
    <authorgroup>
      <author>
        <personname>
          <firstname>Lauren</firstname>
          <surname>Wood</surname>
        </personname>
        <affiliation>
          <orgname>Textuality Services, Inc.</orgname>
        </affiliation>
      </author>
      <author>
        <personname>
          <firstname>Matt</firstname>
          <surname>Patterson</surname>
        </personname>
        <affiliation>
          <orgname>Constituent Parts, Ltd.</orgname>
        </affiliation>
      </author>
      <author>
        <personname>
          <firstname>Norman </firstname>
          <surname>Walsh</surname>
        </personname>
        <affiliation>
          <orgname>MarkLogic</orgname>
        </affiliation>
      </author>
      <author>
        <personname>
          <firstname>Paul</firstname>
          <surname>Downey</surname>
        </personname>
        <affiliation>
          <orgname>GDS</orgname>
        </affiliation>
      </author>
    </authorgroup>
    <releaseinfo role="version">Version 1.0</releaseinfo>
    <legalnotice>
      <para>Alpha by first name</para>
    </legalnotice>
    <pubdate>2012-09-20</pubdate>
    <copyright>
      <year>2012</year>
      <holder>Lauren Wood, Matt Patterson, Norm Walsh, Paul Downey</holder>
    </copyright>
  </info>
  <foilgroup>
    <title>What does an Annotation do?</title>
    <foil>
      <title>Annotating a line of dialogue</title>
      <para>Let's assume that Users (scholars, enthusiasts) want to add annotations to individual lines of dialogue in the play.</para>
    </foil>
    <foil>
      <title>Locating lines of dialogue within the HTML</title>
      <itemizedlist>
        <listitem><para>Regularity of the source markup</para></listitem>
        <listitem><para>Consistent structures</para></listitem>
        <listitem><para>IDs</para></listitem>
      </itemizedlist>
    </foil>
    <foil>
      <title>A quick introduction to jQuery &amp; the Web Inspector</title>
      <para>DEMOTIME</para>
    </foil>
  </foilgroup>
  <foilgroup>
    <title>Adding a form for Annotations in the body of the Act HTML</title>
    <foil>
      <title>Building form HTML in Javascript</title>
      <para>jQuery has a set of DOM manipulation functions</para>
      <para>http://api.jquery.com/category/manipulation/</para>
    </foil>
    <foil>
      <title>Inserting chunks of HTML</title>
      <para>Create new HTML from a string and append it to an element with id <code>id</code></para>
      <programlisting language="javascript"><![CDATA[$('#id').append('<p>Hello World</p>');]]></programlisting>
      <para>Create new HTML, store it, them append it.</para>
      <programlisting language="javascript"><![CDATA[var hello_html = $('<p>Hello World</p>');
$('#id').append(hello_html);]]></programlisting>

    </foil>
    <foil>
      <title>Building the form HTML</title>
      <programlisting lanuguage="javascript"><xi:include href="ex/annotation-form-fragment.js" parse="text"/></programlisting>
    </foil>
    <foil>
      <title>Inserting the form into every line of dialogue</title>
      <para>Our XSLT renders the dialogue like this:</para>
      <programlisting language="html"><![CDATA[
<div class="sp" id="idm150112">
  <div class="speaker italic" id="idm149856">
Flauius.</div>
  <div class="ab" id="idm149248">Hence: home you idle 
Creatures, get you home:<br/>Is this a Holiday? What, 
know you not<br/>(Being Mechanicall) you ought not 
walke<br/>Vpon a labouring day, without the signe<br/>
Of your Profession? Speake, what Trade art thou?<br/>
  </div>
</div>
]]>
      </programlisting>
    </foil>
    <foil>
      <title>Inserting the form into every line of dialogue</title>
      <programlisting language="javascript"><![CDATA[
$('div.sp').each(function() {
  var line_node = $(this);
  var form_node = $(form).appendTo(line_node);
  form_node.find(
    "input[name='annotation[id]']"
  ).val(this.id);
});]]>
      </programlisting>
    </foil>
    <foil>
      <title>Showing and hiding the form</title>
      <programlisting language="javascript"><![CDATA[
 var annotation_controls = '<p class="annotation controls">
   <a href="#show" class="show">Show</a>
   <a href="#add" class="add">+</a></p>'
 ]]>
      </programlisting>
    </foil>
  </foilgroup>
  <foilgroup>
    <title>The Annotation object</title>
    <foil>
      <title>Modelling Annotations</title>
    </foil>
    <foil>
      <title>Implementation</title>
    </foil>
  </foilgroup>
  <foilgroup>
    <title>Adding Annotations to the body of the Act HTML</title>
    <foil>
      <title>Getting the annotations to the Browser</title>
    </foil>
    <foil>
      <title>Why not insert them in the XSLT stage?</title>
    </foil>
    <foil>
      <title>Building an Array of Annotations</title>
    </foil>
    <foil>
      <title>JSON is just Javascript</title>
    </foil>
    <foil>
      <title>Inserting the Annotations</title>
    </foil>
  </foilgroup>
  <foilgroup>
    <title>Adding Annotations without reloading the page</title>
    <foil>
      <title>Hijacking the form</title>
    </foil>
    <foil>
      <title>Preventing it submitting anyway</title>
    </foil>
    <foil>
      <title>POSTing</title>
    </foil>
    <foil>
      <title>The success callback</title>
    </foil>
    <foil>
      <title>Refactoring the code</title>
    </foil>
    <foil>
      <title>Global namespace pollution</title>
    </foil>
  </foilgroup>
  <foilgroup>
    <title>Responding appropriately to Ajax posts</title>
    <foil>
      <title>Choosing the response format</title>
    </foil>
    <foil>
      <title><code>request.xhr?</code></title>
    </foil>
    <foil>
      <title>Content Negotiation</title>
    </foil>
  </foilgroup>
  <foilgroup>
    <title>Showing and hiding annotations on demand</title>
    <foil>
      <title>jQuery show/hide</title>
    </foil>
    <foil>
      <title>Toggling</title>
    </foil>
    <foil>
      <title>Where does the state live?</title>
    </foil>
  </foilgroup>
  <foilgroup>
    <title>Unobtrusively indicating the presence of annotations</title>
    <foil>
      <title>CSS manipulation</title>
    </foil>
    <foil>
      <title>Multiple triggers</title>
    </foil>
  </foilgroup>
</slides>
